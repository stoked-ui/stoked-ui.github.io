"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1876],{14721:function(e,t,n){n.d(t,{T:function(){return T}});var r=n(45711),i=n(36063),o=n(65784),a=n(92379),c=n(62534),l=n(77539),s=n(5652),u=n(85470),d=n(30459),f=n(69974),h=n(91374),v=n(48809);function getTimelineLabelsUtilityClass(e){return(0,v.ZP)("MuiTimelineLabels",e)}(0,n(62234).Z)("MuiTimelineLabels",["root","label"]);var p=n(651),useUtilityClasses=function(e){var t=e.classes;return(0,c.Z)({root:["root"],label:["label"]},getTimelineLabelsUtilityClass,t)},g=(0,s.ZP)("div",{name:"MuiTimelineLabels",slot:"root",overridesResolver:function(e,t){return t.icon}})(function(e){return e.theme,{width:"150px",marginTop:"42px",height:"258px",flex:"0 1 auto",overflow:"overlay"}}),m=(0,s.ZP)("div",{name:"MuiTimelineLabel",slot:"Label",overridesResolver:function(e,t){return t.icon}})(function(e){var t=e.theme;return{height:"32px",padding:"2px",width:"100%",display:"flex",justifyContent:"center",alignItems:"center","& div":{color:t.palette.text.primary,height:"28px",width:"100%",borderRadius:"4px",display:"flex",alignItems:"center",paddingLeft:"6px",backgroundColor:t.palette.grey.A200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textWrap:"nowrap"}}}),x=a.forwardRef(function(e,t){var n,r=(0,d.Z)({props:e,name:"MuiTimelineLabels"}),i=r.tracks,o=r.slots,a=r.slotProps,c=(r.sx,r.timelineState),s=useUtilityClasses(e),u=null!==(n=null==o?void 0:o.root)&&void 0!==n?n:g;return(0,l.y)({elementType:u,externalSlotProps:null==a?void 0:a.root,className:s.root,ownerState:e}),(0,p.jsx)(u,{ref:t,setTracks:e.setTracks,style:{overflow:"overlay"},onScroll:function(e){var t;null===(t=c.current)||void 0===t||t.setScrollTop(e.target.scrollTop)},classes:s,className:"".concat(s.root," timeline-list"),children:null==i?void 0:i.map(function(e){return(0,p.jsx)(m,{className:s.label,children:(0,p.jsx)("div",{children:e.name})},e.id)})})}),b=n(94161),y=["sx"],Timeline_useUtilityClasses=function(e){var t=e.classes;return(0,c.Z)({root:["root"],labels:["labels"],control:["control"]},h.a,t)},S=(0,s.ZP)("div",{name:"MuiTimeline",slot:"Root",overridesResolver:function(e,t){return t.root}})(function(e){var t=e.theme;return{display:"flex",backgroundColor:(0,u._4)(t.palette.background.default,.04),"&:hover":{"& .SuiScrollbar":{height:"12px"}}}}),T=a.forwardRef(function(e,t){var n,c,s,u,h=(0,d.Z)({props:e,name:"MuiTimeline"}),v=h.slots,g=h.slotProps,m=h.setTracks,T=h.controlSx,w=h.tracks,k=h.onChange,C=h.trackSx;e.sx,(0,o.Z)(e,y);var R=Timeline_useUtilityClasses(e),L=a.useRef(null),Z=a.useRef(null),E=(0,f.Z)(e.timelineState,Z),_=a.useRef(null),A=(0,f.Z)(t,_),M=null!==(n=null==v?void 0:v.root)&&void 0!==n?n:S,W=(0,l.y)({elementType:M,externalSlotProps:null==g?void 0:g.root,className:R.root,ownerState:(0,i.Z)({},e)}),P=null!==(c=null==v?void 0:v.labels)&&void 0!==c?c:x,D=a.useRef(null),I=(0,l.y)({elementType:M,externalSlotProps:null==g?void 0:g.labels,className:R.labels,ownerState:(0,i.Z)((0,i.Z)({},e),{},{sx:e.labelsSx,timelineState:L})}),z=null!==(s=null==v?void 0:v.root)&&void 0!==s?s:b.s;return a.useRef(null),(0,l.y)({elementType:z,externalSlotProps:null==g?void 0:g.control,className:R.root,ownerState:{sx:T,trackSx:C,tracks:w,setTracks:m}}),(0,p.jsxs)(M,(0,i.Z)((0,i.Z)({ref:A},W),{},{sx:e.sx,children:[(0,p.jsx)(P,(0,i.Z)((0,i.Z)({ref:D},I.ownerState),{},{timelineState:L,onChange:k})),(0,p.jsx)(z,{sx:{width:"100%",flex:"1 1 auto","&-action":{height:"28px !important",top:"50%",transform:"translateY(-50%)"}},onDoubleClickRow:function(e,t){var n=t.track,o=t.time;m(function(e){var t=e.findIndex(function(e){return e.id===n.id}),a={id:"action ".concat(w.length),start:o,end:o+.5,effectId:"effect0"};return e[t]=(0,i.Z)((0,i.Z)({},n),{},{actions:[].concat((0,r.Z)(n.actions),[a])}),(0,r.Z)(e)})},onKeyDown:function(t){t.preventDefault();var n=e.engine.current.getSelectedActions();null==n||n.forEach(function(e){e.action.onKeyDown(t,"keyDown")})},onScroll:function(e){var t=e.scrollTop;D.current&&(D.current.scrollTop=t)},startLeft:10,ref:E,scaleWidth:e.scaleWidth,setScaleWidth:e.setScaleWidth,engine:e.engine,onChange:k,tracks:w,autoScroll:!0,setTracks:m,className:"SuiTimeline",actionTypes:e.actionTypes,viewSelector:null!==(u=e.viewSelector)&&void 0!==u?u:".viewer",onClickAction:function(e,t){var n=t.track,i=t.action;t.time,m(function(e){var t=e.findIndex(function(e){return e.id===n.id}),o=n.actions.findIndex(function(e){return e.id===i.id});return e.forEach(function(e,n){e.selected=!1,e.actions.forEach(function(r,i){t===n&&i===o?(console.log("selected",r.name,"index",i,"on track",n),r.selected=!0,e.selected=!0):r.selected=!1})}),(0,r.Z)(e)})}})]}))})},91374:function(e,t,n){n.d(t,{K:function(){return i},a:function(){return getTimelineUtilityClass}});var r=n(48809);function getTimelineUtilityClass(e){return(0,r.ZP)("MuiTimeline",e)}var i=(0,n(62234).Z)("MuiTimeline",["root","labels","control"])},12056:function(e,t,n){n.d(t,{Z:function(){return TimelineAction_TimelineAction},k:function(){return useActionUtilityClasses}});var r=n(45711),i=n(53710),o=n(36063),a=n(65784),c=n(51041),l=n.n(c),s=n(92379),u=n(5652),d=n(85470),f=n(62534),h=n(53048),v=n(15409),p=n(3881),g=n(65184),m=n(92411),x=n(88252),b=n(48809);function getTimelineActionUtilityClass(e){return(0,b.ZP)("MuiTimelineAction",e)}(0,n(62234).Z)("MuiTimelineAction",["root","left","right","selected","flexible","movable","disable"]);var y=n(77378),S=n(651),T=["slotProps","action"],w=["onKeyDown"],useActionUtilityClasses=function(e){var t=e.classes;return(0,f.Z)({root:["root"],left:["left"],right:["right"],selected:["selected"],flexible:["flexible"],movable:["movable"],disable:["disable"]},getTimelineActionUtilityClass,t)},k=(0,u.ZP)("div",{name:"MuiTimelineAction",slot:"root",overridesResolver:function(e,t){return t.root},shouldForwardProp:function(e){return(0,p.shouldForwardProp)(e)&&"selected"!==e}})(function(e){var t=e.theme,n=e.selected,r=e.color,i=void 0===r?"blue":r;t.vars||(0,d.Fq)(i,1);var o=(0,d._4)(i,.7),a=(0,d._4)(i,.45),c=(0,d._4)(i,.3);return{position:"absolute",left:0,top:0,backgroundColor:n?c:o,alignContent:"center",padding:"0 0 0 10px",overflow:"hidden",textWrap:"nowrap",borderTop:"1px solid ".concat(t.palette.action.hover),borderBottom:"1px solid ".concat(t.palette.action.hover),"&:hover":{backgroundColor:a}}}),C=(0,u.ZP)("div")(function(e){var t=e.theme;return{position:"absolute",top:0,width:"10px",borderRadius:"4px",height:"100%",overflow:"hidden",left:0,"&::after":{position:"absolute",top:0,bottom:0,margin:"auto",bordeRadius:"4px",borderTop:"28px solid transparent",borderBottom:"28px solid transparent",left:0,content:"''",borderLeft:"7px solid ".concat(t.palette.action.disabled),borderRight:"7px solid transparent"}}}),R=(0,u.ZP)("div")(function(e){var t=e.theme;return{position:"absolute",top:0,width:"10px",borderRadius:"4px",height:"100%",overflow:"hidden",right:0,"&::after":{position:"absolute",top:0,bottom:0,margin:"auto",bordeRadius:"4px",borderTop:"28px solid transparent",borderBottom:"28px solid transparent",right:0,content:"''",borderLeft:"7px solid transparent",borderRight:"7px solid ".concat(t.palette.action.disabled)}}}),TimelineAction_TimelineAction=function TimelineAction(e){var t,n,c=e.slotProps,u=e.action,d=(0,a.Z)(e,T),f=u.selected,p=u.flexible,b=void 0===p||p,L=u.movable,Z=void 0===L||L,E={selected:f,flexible:b,movable:Z,disable:u.disable},_=(0,o.Z)((0,o.Z)((0,o.Z)({},E),d),u);_.onKeyDown;var A=(0,a.Z)(_,w),M=useActionUtilityClasses(A),W=l()(M).reduce(function(e,t){return e[M[t]]=!!E[t],e},{});(0,v.Z)({elementType:TimelineAction,externalSlotProps:(void 0===c?{}:c).root,externalForwardedProps:e,ownerState:A,className:(0,h.default)(e.className,M.root,W)});var P=s.useRef(),D=s.useRef(!1),I=u.id,z=u.maxEnd,j=u.minStart,O=u.end,N=u.start,U=u.effectId,F=e.track,B=e.scaleCount,G=e.setScaleCount,X=e.actionTypes,H=e.startLeft,q=e.scale,V=e.scaleWidth,$=e.maxScaleCount,K=e.scaleSplitCount,Q=(0,m.ES)(j||0,{startLeft:H,scale:q,scaleWidth:V}),Y=Math.min($*V+H,(0,m.ES)(z||Number.MAX_VALUE,{startLeft:H,scale:q,scaleWidth:V})),J=s.useState(function(){return(0,m.RD)({start:N,end:O},{startLeft:H,scale:q,scaleWidth:V})}),ee=(0,i.Z)(J,2),et=ee[0],en=ee[1];s.useEffect(function(){F.lock||en((0,m.RD)({start:N,end:O},{startLeft:H,scale:q,scaleWidth:V}))},[O,N,H,V,q]);var er=V/K,ei=["action"];Z&&!F.lock&&ei.push("action-movable"),f&&ei.push("action-selected"),b&&ei.push("action-flexible"),null!=X&&X[U]&&ei.push("action-actionType-".concat(U));var handleScaleCount=function(e,t){var n=(0,m.rQ)(e+t,{startLeft:H,scaleCount:B,scaleWidth:V});n!==B&&G(n)},eo=e.onActionMoveStart,ea=e.onActionMoving,ec=e.tracks,el=e.setEditorData,es=e.onActionMoveEnd,eu=e.onActionResizeStart,ed=e.onActionResizing,ef=e.onActionResizeEnd,eh=(0,o.Z)((0,o.Z)({},u),(0,m.o$)({left:et.left,width:et.width},{startLeft:H,scaleWidth:V,scale:q})),ev=(0,o.Z)((0,o.Z)({},F),{},{actions:(0,r.Z)(F.actions)});F.actions.includes(u)&&(ev.actions[F.actions.indexOf(u)]=eh);var ep=e.areaRef,eg=e.gridSnap,em=e.dragLineData,ex=e.disableDrag,eb=e.deltaScrollLeft,ey=e.onClickAction,eS=e.handleTime,eT=e.onClickActionOnly,ew=e.onDoubleClickAction,ek=e.onContextMenuAction,eC=e.rowHeight,eR=e.getActionRender;return(0,S.jsx)(x.d,{ref:P,parentRef:ep,start:H,left:et.left,width:et.width,grid:eg&&er||g.e6,adsorptionDistance:eg?Math.max((er||g.e6)/2,g.G1):g.G1,adsorptionPositions:em.assistPositions,bounds:{left:Q,right:Y},edges:{left:!ex&&b&&".".concat((0,y.O)("action-left-stretch")),right:!ex&&b&&".".concat((0,y.O)("action-right-stretch"))},enableDragging:!ex&&Z,enableResizing:!ex&&b,onDragStart:function(){!F.lock&&eo&&eo({action:u,track:F})},onDrag:function(e){var t=e.left,n=e.width;if(!F.lock){if(D.current=!0,ea){var r=(0,m.o$)({left:t,width:n},{scaleWidth:V,scale:q,startLeft:H});if(!1===ea({action:u,track:F,start:r.start,end:r.end}))return}en({left:t,width:n}),handleScaleCount(t,n)}},onDragEnd:function(e){var t=e.left,n=e.width;if(!F.lock){var r=(0,m.o$)({left:t,width:n},{scaleWidth:V,scale:q,startLeft:H}),i=r.start,o=r.end,a=ec.find(function(e){return e.id===F.id}).actions.find(function(e){return e.id===I});a.start=i,a.end=o,el(ec),es&&es({action:a,track:F,start:i,end:o})}},onResizeStart:function(e){!F.lock&&eu&&eu({action:u,track:F,dir:e})},onResize:function(e,t){var n=t.left,r=t.width;if(!F.lock){if(D.current=!0,ed){var i=(0,m.o$)({left:n,width:r},{scaleWidth:V,scale:q,startLeft:H});if(!1===ed({action:u,track:F,start:i.start,end:i.end,dir:e}))return}en({left:n,width:r}),handleScaleCount(n,r)}},onResizeEnd:function(e,t){var n=t.left,r=t.width;if(!F.lock){var i=(0,m.o$)({left:n,width:r},{scaleWidth:V,scale:q,startLeft:H}),o=i.start,a=i.end,c=ec.find(function(e){return e.id===F.id}).actions.find(function(e){return e.id===I});c.start=o,c.end=a,el(ec),ef&&ef({action:c,track:F,start:o,end:a,dir:e})}},deltaScrollLeft:eb,children:(0,S.jsxs)(k,{id:u.id,onKeyDown:function(e){e.currentTarget=u,u.onKeyDown(e,u.id),e.preventDefault()},onMouseDown:function(){F.lock||(D.current=!1)},onClick:function(e){var t;F.lock||(u.selected=!0,ey&&(t=eS(e),ey(e,{track:F,action:u,time:t})),!D.current&&eT&&(t||(t=eS(e)),eT(e,{track:F,action:u,time:t})))},onDoubleClick:function(e){if(!F.lock&&ew){var t=eS(e);ew(e,{track:F,action:u,time:t})}},onContextMenu:function(e){if(!F.lock&&ek){var t=eS(e);ek(e,{track:F,action:u,time:t})}},className:(0,y.O)((ei||[]).join(" ")),selected:u.selected,style:{height:eC},color:null!==(t=null==X?void 0:null===(n=X[u.effectId])||void 0===n?void 0:n.color)&&void 0!==t?t:"#ccc",children:[eR&&eR(eh,ev),b&&(0,S.jsx)(C,{className:M.left}),b&&(0,S.jsx)(R,{className:M.right})]})})}},94161:function(e,t,n){n.d(t,{s:function(){return V}});var r,i,o,a=n(36063),c=n(53710),l=n(66286),s=n.n(l),u=n(92379),d=n(95880),f=n(28030),h=n(65184),v=n(53882),p=n.n(v),g=n(43880),m=n(76760),x=n(43640);(r=i||(i={}))[r.VERBOSE=0]="VERBOSE",r[r.LOG=1]="LOG",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.FATAL=5]="FATAL",r[r.SILENT=1/0]="SILENT";var b={VERBOSE:i.VERBOSE,LOG:i.LOG,INFO:i.INFO,WARN:i.WARN,ERROR:i.ERROR,SILENT:i.SILENT};function colorize(e,t){return"color:".concat(e,";font-size:").concat(t,"px;")}var y=function(){function ConsoleLogger(e){(0,g.Z)(this,ConsoleLogger),(0,x.Z)(this,"Levels",b),(0,x.Z)(this,"level",i.LOG),(0,x.Z)(this,"prefix",""),(0,x.Z)(this,"enabled",!0),(0,x.Z)(this,"debugColor",colorize("#cccccc",12)),(0,x.Z)(this,"logColor",colorize("#bbbbbb",12)),(0,x.Z)(this,"infoColor",colorize("#2196f3",12)),(0,x.Z)(this,"warnColor",colorize("#ff00ff",12)),(0,x.Z)(this,"errorColor",colorize("#e91e63",12)),(0,x.Z)(this,"fatalColor",colorize("#9a0101",13)),this.setPrefix(e),this.level=ConsoleLogger.level,ConsoleLogger.instances.push(this)}return(0,m.Z)(ConsoleLogger,[{key:"setPrefix",value:function(e){this.prefix=e}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.level;this.level=e,this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}},{key:"setLevel",value:function(e){this.level=e}},{key:"trace",value:function(e){if(this.enabled&&!(this.level>i.VERBOSE)){for(var t,n,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];ConsoleLogger.noColor?(t=console).trace.apply(t,["[".concat(this.prefix,"] ").concat(e)].concat(o)):(n=console).trace.apply(n,["%c[".concat(this.prefix,"] ").concat(e),this.debugColor].concat(o))}}},{key:"debug",value:function(e){if(this.enabled&&!(this.level>i.VERBOSE)){for(var t,n,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];ConsoleLogger.noColor?(t=console).debug.apply(t,["[".concat(this.prefix,"] ").concat(e)].concat(o)):(n=console).debug.apply(n,["%c[".concat(this.prefix,"] ").concat(e),this.debugColor].concat(o))}}},{key:"log",value:function(e){if(this.enabled&&!(this.level>i.LOG)){for(var t,n,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];ConsoleLogger.noColor?(t=console).log.apply(t,["[".concat(this.prefix,"] ").concat(e)].concat(o)):(n=console).log.apply(n,["%c[".concat(this.prefix,"] ").concat(e),this.logColor].concat(o))}}},{key:"info",value:function(e){if(this.enabled&&!(this.level>i.INFO)){for(var t,n,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];ConsoleLogger.noColor?(t=console).info.apply(t,["[".concat(this.prefix,"] ").concat(e)].concat(o)):(n=console).info.apply(n,["%c[".concat(this.prefix,"] ").concat(e),this.infoColor].concat(o))}}},{key:"warn",value:function(e){if(this.enabled&&!(this.level>i.WARN)){for(var t,n,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];ConsoleLogger.noColor?(t=console).warn.apply(t,["[".concat(this.prefix,"] ").concat(e)].concat(o)):(n=console).warn.apply(n,["%c[".concat(this.prefix,"] ").concat(e),this.warnColor].concat(o))}}},{key:"error",value:function(e){if(this.enabled&&!(this.level>i.ERROR)){for(var t,n,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];ConsoleLogger.noColor?(t=console).error.apply(t,["[".concat(this.prefix,"] ").concat(e)].concat(o)):(n=console).error.apply(n,["%c[".concat(this.prefix,"] ").concat(e),this.errorColor].concat(o))}}},{key:"fatal",value:function(e){if(this.enabled&&!(this.level>i.FATAL)){for(var t,n,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];ConsoleLogger.noColor?(t=console).error.apply(t,["[".concat(this.prefix,"] ").concat(e)].concat(o)):(n=console).error.apply(n,["%c[".concat(this.prefix,"] ").concat(e),this.fatalColor].concat(o))}}},{key:"group",value:function(){if(console.group){var e;(e=console).group.apply(e,arguments)}}},{key:"groupEnd",value:function(){console.groupEnd&&console.groupEnd()}},{key:"groupCollapsed",value:function(){if(console.groupCollapsed){var e;(e=console).groupCollapsed.apply(e,arguments)}}}],[{key:"setLevel",value:function(e){this.level=e,this.instances.forEach(function(t){return t.setLevel(e)})}},{key:"enable",value:function(e){e&&(this.level=e),this.instances.forEach(function(e){return e.enable()})}},{key:"disable",value:function(){this.instances.forEach(function(e){return e.disable()})}}]),ConsoleLogger}();(0,x.Z)(y,"instances",[]),(0,x.Z)(y,"level",i.LOG),(0,x.Z)(y,"Levels",b),(0,x.Z)(y,"noColor",!1);var S=new y("timeline"),T=n(92411),w=n(5652),k=n(77378),C=n(88252),R=n(651),L=(0,w.ZP)("div")({cursor:"ew-resize",position:"absolute",top:"34px",height:"100%",boxSizing:"border-box",borderLeft:"1px solid #5297FF",borderRight:"1px solid #5297FF",transform:"translateX(-25%) scaleX(0.5)"}),Z=(0,w.ZP)("svg")({position:"absolute",top:"0px",left:"50%",transform:"translate(-50%, 0) scaleX(2)",margin:"auto"}),E=(0,w.ZP)("div")({width:"16px",height:"calc(100% - 34px)",cursor:"ew-resize",position:"absolute",top:0,left:"50%",transform:"translateX(-50%)"}),Cursor=function(e){var t=e.disableDrag,n=e.cursorTime,r=e.setCursor,i=e.startLeft,a=e.timelineWidth,c=e.scaleWidth,l=e.scale,s=e.scrollLeft,d=e.scrollSync,f=e.areaRef,h=e.maxScaleCount,v=e.deltaScrollLeft,p=e.onCursorDragStart,g=e.onCursorDrag,m=e.onCursorDragEnd,x=u.useRef(),b=u.useRef();return u.useEffect(function(){void 0===b.current&&x.current.updateLeft((0,T.ES)(n,{startLeft:i,scaleWidth:c,scale:l})-s)},[n,i,c,l,s]),(0,R.jsx)(C.d,{start:i,ref:x,parentRef:f,bounds:{left:0,right:Math.min(a,h*c+i-s)},deltaScrollLeft:v,enableDragging:!t,enableResizing:!1,onDragStart:function(){p&&p(n),b.current=(0,T.ES)(n,{startLeft:i,scaleWidth:c,scale:l})-s,x.current.updateLeft(b.current)},onDragEnd:function(){var e=(0,T.bW)(b.current+s,{startLeft:i,scale:l,scaleWidth:c});r({time:e}),m&&m(e),b.current=void 0},onDrag:function(e){var t=e.left,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=d.current.state.scrollLeft;n&&0!==o?b.current<i-o-n&&(b.current=i-o-n):t<i-o?b.current=i-o:b.current=t,x.current.updateLeft(b.current);var a=(0,T.bW)(b.current+o,{startLeft:i,scale:l,scaleWidth:c});return r({time:a}),g&&g(a),!1},children:(0,R.jsxs)(L,{children:[o||(o=(0,R.jsx)(Z,{width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",children:(0,R.jsx)("path",{d:"M0 1C0 0.447715 0.447715 0 1 0H7C7.55228 0 8 0.447715 8 1V9.38197C8 9.76074 7.786 10.107 7.44721 10.2764L4.44721 11.7764 C4.16569 11.9172 3.83431 11.9172 3.55279 11.7764L0.552786 10.2764C0.214002 10.107 0 9.76074 0 9.38197V1Z",fill:"#5297FF"})})),(0,R.jsx)(E,{className:(0,k.O)("cursor-area")})]})})},_=(0,w.ZP)("div")({position:"absolute",height:"100%",top:0,left:0}),A=(0,w.ZP)("div")({width:0,position:"absolute",top:0,height:"99%",borderLeft:"1px dashed rgba(82, 151, 255, 0.6)"});function DragLines(e){var t=e.isMoving,n=e.movePositions,r=e.assistPositions,i=void 0===r?[]:r,o=e.scrollLeft;return(0,R.jsx)(_,{className:(0,k.O)("drag-line-container"),children:t&&(void 0===n?[]:n).filter(function(e){return i.includes(e)}).map(function(e,t){return(0,R.jsx)(A,{className:(0,k.O)("drag-line"),style:{left:e-o}},t)})})}var M=n(12056),W=(0,w.ZP)("div",{name:"MuiTimelineTrack",slot:"Root"})(function(e){var t=e.theme;return{backgroundRepeat:"no-repeat, repeat",backgroundImage:"linear-gradient(#0000, #0000), linear-gradient(90deg, ".concat(t.palette.action.selected," 1px, transparent 0)"),display:"flex",flexDirection:"row",boxSizing:"border-box"}});function EditRow(e){var t=e.rowData,n=e.style,r=e.onClickRow,i=e.onDoubleClickRow,o=e.onContextMenuRow,c=e.areaRef,l=e.scrollLeft,s=e.startLeft,u=e.scale,d=e.scaleWidth,f=["edit-track"];null!=t&&t.selected&&f.push("edit-track-selected");var handleTime=function(e){if(c.current){var t=c.current.getBoundingClientRect(),n=e.clientX-t.x;return(0,T.bW)(n+l,{startLeft:s,scale:u,scaleWidth:d})}};return(0,R.jsx)(W,{className:"".concat(k.O.apply(void 0,f)," ").concat(((null==t?void 0:t.classNames)||[]).join(" ")),style:void 0===n?{}:n,onKeyDown:function(e){console.log("row root",e)},onClick:function(e){if(t&&r){var n=handleTime(e);r(e,{track:t,time:n})}},onDoubleClick:function(e){if(t&&i){var n=handleTime(e);i(e,{track:t,time:n})}},onContextMenu:function(e){if(t&&o){var n=handleTime(e);o(e,{track:t,time:n})}},children:((null==t?void 0:t.actions)||[]).map(function(n){return(0,R.jsx)(M.Z,(0,a.Z)((0,a.Z)({},e),{},{handleTime:handleTime,track:t,action:n}),n.id)})})}var P=n(45711),D=(0,w.ZP)("div")(function(e){return e.theme,{flex:"1 1 auto",marginTop:"10px",overflow:"hidden",position:"relative",height:"100%",minHeight:"fit-content","& .ReactVirtualized__Grid":{outline:"none !important",overflow:"overlay !important","&::-webkit-scrollbar":{width:0,height:0,display:"none"}}}}),I=u.forwardRef(function(e,t){var n,r,i,o,l=e.tracks,s=e.rowHeight,d=e.scaleWidth,h=e.scaleCount,v=e.startLeft,p=e.scrollLeft,g=e.scrollTop,m=e.scale,x=e.hideCursor,b=e.cursorTime,y=e.onScroll,S=e.dragLine,w=e.getAssistDragLineActionIds,C=e.onActionMoveEnd,L=e.onActionMoveStart,Z=e.onActionMoving,E=e.onActionResizeEnd,_=e.onActionResizeStart,A=e.onActionResizing,M=(n=u.useState({isMoving:!1,movePositions:[],assistPositions:[]}),i=(r=(0,c.Z)(n,2))[0],o=r[1],{initDragLine:function(e){o({isMoving:!0,movePositions:e.movePositions||[],assistPositions:e.assistPositions||[]})},updateDragLine:function(e){var t=e.movePositions,n=e.assistPositions;o(function(e){return(0,a.Z)((0,a.Z)({},e),{},{movePositions:t||e.movePositions,assistPositions:n||e.assistPositions})})},disposeDragLine:function(){o({isMoving:!1,movePositions:[],assistPositions:[]})},dragLineData:i,defaultGetAssistPosition:function(e){var t=e.tracks,n=e.assistActionIds,r=e.action,i=e.track,o=e.scale,a=e.scaleWidth,c=e.startLeft,l=e.cursorLeft,s=e.hideCursor,u=[];n?t.forEach(function(e){e.actions.forEach(function(e){n.includes(e.id)&&u.push(e)})}):t.forEach(function(e){e.id!==i.id?u.push.apply(u,(0,P.Z)(e.actions)):e.actions.forEach(function(e){e.id!==r.id&&u.push(e)})});var d=(0,T.EB)(u,{startLeft:void 0===c?20:c,scale:void 0===o?1:o,scaleWidth:void 0===a?160:a});return s||d.push(l),d},defaultGetMovePosition:function(e){var t=e.start,n=e.end,r=e.dir,i=e.scale,o=e.scaleWidth,a=e.startLeft,c=(0,T.RD)({start:t,end:n},{startLeft:a,scaleWidth:o,scale:i}),l=c.left,s=c.width;return r?"right"===r?[l+s]:[l]:[l,l+s]}}),W=M.dragLineData,I=M.initDragLine,z=M.updateDragLine,j=M.disposeDragLine,O=M.defaultGetAssistPosition,N=M.defaultGetMovePosition,U=u.useRef(),F=u.useRef(),B=u.useRef(-1);u.useImperativeHandle(t,function(){return{get domRef(){return U}}});var handleInitDragLine=function(e){if(S){var t=w&&w({action:e.action,track:e.track,tracks:l}),n=(0,T.ES)(b,{scaleWidth:d,scale:m,startLeft:v});I({assistPositions:O({tracks:l,assistActionIds:t,action:e.action,track:e.track,scale:m,scaleWidth:d,startLeft:v,hideCursor:x,cursorLeft:n})})}},handleUpdateDragLine=function(e){S&&z({movePositions:N((0,a.Z)((0,a.Z)({},e),{},{startLeft:v,scaleWidth:d,scale:m}))})},cellRenderer=function(t){var n=t.rowIndex,r=t.key,i=t.style,o=l[n];return(0,u.createElement)(EditRow,(0,a.Z)((0,a.Z)({},e),{},{style:(0,a.Z)((0,a.Z)({},i),{},{backgroundPositionX:"0, ".concat(v,"px"),backgroundSize:"".concat(v,"px, ").concat(d,"px")}),areaRef:U,key:r,rowHeight:(null==o?void 0:o.rowHeight)||s,rowData:o,dragLineData:W,onActionMoveStart:function(e){return handleInitDragLine(e),L&&L(e)},onActionResizeStart:function(e){return handleInitDragLine(e),_&&_(e)},onActionMoving:function(e){return handleUpdateDragLine(e),Z&&Z(e)},onActionResizing:function(e){return handleUpdateDragLine(e),A&&A(e)},onActionResizeEnd:function(e){return j(),E&&E(e)},onActionMoveEnd:function(e){return j(),C&&C(e)}}))};return u.useEffect(function(){var e;null===(e=F.current)||void 0===e||e.scrollToPosition({scrollTop:g,scrollLeft:p})},[g,p]),u.useEffect(function(){F.current.recomputeGridSize()},[l]),(0,R.jsxs)(D,{ref:U,className:"SuiTimelineEditArea-root ".concat((0,k.O)("edit-area")),children:[(0,R.jsx)(f.qj,{className:"auto-sizer",style:{height:"fit-content"},children:function(e){var t,n=e.width,r=e.height,i=0,o=null==l?void 0:l.map(function(e){var t=e.rowHeight||s;return i+=t,t});return i<r&&o&&(o.push(r-i),B.current!==r&&B.current>=0&&setTimeout(function(){var e,t;return null===(e=F.current)||void 0===e?void 0:e.recomputeGridSize({rowIndex:null!==(t=null==o?void 0:o.length)&&void 0!==t?t:-1})})),B.current=r,console.log("grid",n,r,i),(0,R.jsx)(f.rj,{id:"thisisedit",columnCount:1,rowCount:null!==(t=null==o?void 0:o.length)&&void 0!==t?t:0,ref:F,style:{overscrollBehavior:"none"},cellRenderer:cellRenderer,columnWidth:Math.max(h*d+v,n),width:n,height:i,rowHeight:function(e){return o[e.index]||s},overscanRowCount:10,overscanColumnCount:0,onScroll:function(e){y(e)}})}}),S&&(0,R.jsx)(DragLines,(0,a.Z)({scrollLeft:p},W))]})}),z=n(85470),j=(0,w.ZP)("div")(function(e){var t=e.theme;return{position:"relative",height:"32px",flex:"0 0 auto",backgroundColor:(0,z._4)(t.palette.background.default,.04),"& .ReactVirtualized__Grid":{outline:"none","&::-webkit-scrollbar":{display:"none"}}}}),O=(0,w.ZP)("div")(function(e){return{color:e.theme.palette.text.secondary,position:"absolute",right:0,top:0,transform:"translate(50%, -100%)"}}),N=(0,w.ZP)("div")({position:"absolute",cursor:"pointer",left:0,top:0}),U=(0,w.ZP)("div")(function(e){var t=e.theme;return{borderRight:"1px solid ".concat(t.palette.text.primary),position:"relative",boxSizing:"content-box",height:"4px !important",bottom:"0 !important",top:"auto !important","&-big":{height:"8px !important"}}}),TimeArea=function(e){var t=e.setCursor,n=e.maxScaleCount,r=e.hideCursor,i=e.scale,o=e.scaleWidth,a=e.scaleCount,c=e.scaleSplitCount,l=e.startLeft,s=e.scrollLeft,d=e.onClickTimeArea,h=e.getScaleRender,v=u.useRef(),p=c>0,cellRenderer=function(e){var t=e.columnIndex,n=e.key,r=e.style,o=!p||t%c==0,a=["time-unit"];o&&a.push("time-unit-big");var l=(p?t/c:t)*i;return(0,R.jsx)(U,{style:r,className:k.O.apply(void 0,a),children:o&&(0,R.jsx)(O,{className:(0,k.O)("time-unit-scale"),children:h?h(l):l})},n)};u.useEffect(function(){var e;null===(e=v.current)||void 0===e||e.recomputeGridSize()},[o,l]);var getColumnWidth=function(e){return 0===e.index?l:p?o/c:o},g=getColumnWidth({index:1});return(0,R.jsx)(j,{className:(0,k.O)("time-area"),children:(0,R.jsx)(f.qj,{children:function(e){var h=e.width,m=e.height;return(0,R.jsxs)(u.Fragment,{children:[(0,R.jsx)(f.rj,{ref:v,columnCount:p?a*c+1:a,columnWidth:getColumnWidth,estimatedColumnSize:g,rowCount:1,rowHeight:m,width:h,height:m,overscanRowCount:0,overscanColumnCount:10,cellRenderer:cellRenderer,scrollLeft:s}),(0,R.jsx)(N,{style:{width:h,height:m},onClick:function(e){if(!r){var a=e.currentTarget.getBoundingClientRect(),c=Math.max(e.clientX-a.x+s,l);if(!(c>n*o+l-s)){var u=(0,T.bW)(c,{startLeft:l,scale:i,scaleWidth:o});!1!==(d&&d(u,e))&&(console.log("set cursor",u),t({time:u}))}}},className:(0,k.O)("time-area-interact")})]})}})})},F=n(25463),B=(0,F.Z)("div")(function(e){return{width:"100%",height:"0px",backgroundColor:e.theme.palette.action.divider,position:"relative"}}),G=(0,F.Z)("div")(function(e){return{height:"100%",width:"100%",backgroundColor:e.theme.palette.action.hover,position:"relative"}}),X=(0,F.Z)("div")(function(e){e.theme;var t=e.width,n=e.left;return{height:"100%",width:"".concat(t,"px"),minWidth:"40px",backgroundColor:"#55555599",position:"absolute",left:"".concat(n,"%"),display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"}}),H=(0,F.Z)("div")(function(e){return{width:"10px",height:"100%",backgroundColor:e.theme.palette.grey[700],cursor:"ew-resize","&:first-of-type":{borderRadius:"5px 0 0 5px"},"&:last-of-type":{borderRadius:"0 5px 5px 0"}}}),TimelineScrollResizer_ScrollResizer=function(e){var t=e.parentRef,n=e.selector,r=e.minScale,i=void 0===r?.5:r,o=e.maxScale,a=void 0===o?2:o,c=e.scale,l=void 0===c?1:c,s=e.setScale,d=e.setHorizontalScroll,f=(0,u.useState)(!1),h=f[0],v=f[1],p=(0,u.useState)(!1),g=p[0],m=p[1],x=(0,u.useState)(0),b=x[0],y=x[1],S=(0,u.useState)(l),T=S[0],w=S[1],k=(0,u.useState)(0),C=k[0],L=k[1],Z=(0,u.useState)(50),E=Z[0],_=Z[1],A=u.useRef(null);(0,u.useEffect)(function(){if(t.current){var e=t.current.querySelector(n);e&&null!==e&&(A.current=e)}},[t]),(0,u.useEffect)(function(){s&&A.current&&s(l)},[l,A]);var handleMouseDownResize=function(e){e.preventDefault(),v(!0),y(e.clientX),w(l)},getThumbnailWidth=function(){var e=A.current.clientWidth;return e/(A.current.scrollWidth/e)},handleMouseMove=function(e){if(h){var t=T+-.5*(e.clientX-b);t=Math.max(i,Math.min(a,t));var n=getThumbnailWidth();n<=A.current.clientWidth&&(s(t),A.current&&_(Math.max(50,n)))}else if(g){var r,o=e.clientX-b,c=(null===(r=A.current)||void 0===r?void 0:r.clientWidth)||1,l=100-E/(c/100),u=Math.max(0,Math.min(l,C+o/(c-E)*100));console.log("newScrollPosition",u,l),L(u),A.current&&d(u)}},handleMouseUp=function(){v(!1),m(!1)};return(0,u.useEffect)(function(){return h||g?(window.addEventListener("mousemove",handleMouseMove),window.addEventListener("mouseup",handleMouseUp)):(window.removeEventListener("mousemove",handleMouseMove),window.removeEventListener("mouseup",handleMouseUp)),function(){window.removeEventListener("mousemove",handleMouseMove),window.removeEventListener("mouseup",handleMouseUp)}},[h,g]),(0,R.jsx)(B,{className:"SuiScrollbar",children:(0,R.jsx)(G,{children:(0,R.jsxs)(X,{width:E,left:C,onMouseDown:function(e){e.preventDefault(),m(!0),y(e.clientX)},children:[(0,R.jsx)(H,{onMouseDown:handleMouseDownResize}),(0,R.jsx)(H,{onMouseDown:handleMouseDownResize})]})})})},q=(0,d.Z)("div")(function(e){return{width:"100%",minHeight:"max-content",height:"100%",position:"relative",fontSize:"12px",backgroundColor:e.theme.palette.background.paper,display:"flex",flexDirection:"column",overflow:"hidden"}}),V=u.forwardRef(function(e,t){var n,r,i,o,l,d,v,g,m,x,b,y,w,k,C,L,Z,E,_,A=(r=void 0===(n=e.scrollTop)?0:n,o=void 0===(i=e.scale)?h.A$:i,d=void 0===(l=e.scaleSplitCount)?h.IO:l,g=void 0===(v=e.scaleWidth)?h.I:v,x=void 0===(m=e.startLeft)?h.Rz:m,y=void 0===(b=e.minScaleCount)?h.nW:b,k=void 0===(w=e.maxScaleCount)?1/0:w,L=void 0===(C=e.rowHeight)?h.b0:C,o<=0&&(S.error("Error: scale must be greater than 0!"),o=h.A$),r<0&&(S.warn("Warning: scrollTop cannot be less than 0!"),r=0),d<=0&&(S.warn("Warning: scaleSplitCount cannot be less than 1!"),d=1),g<=0&&(S.warn("Warning: scaleWidth must be greater than 0!"),g=h.I),x<0&&(S.warn("Warning: startLeft cannot be less than 0!"),x=0),y<1&&(S.warn("Warning: minScaleCount must be greater than 1!"),y=h.nW),k<(y=p()("".concat(y),10))&&(S.warn("Warning: maxScaleCount cannot be less than minScaleCount!"),k=y),k=k===1/0?1/0:p()("".concat(k),10),L<=0&&(S.warn("Warning: rowHeight must be greater than 0!"),L=h.b0),Z=(0,a.Z)({},e),delete Z.style,(0,a.Z)((0,a.Z)({},Z),{},{tracks:e.tracks,actionTypes:e.actionTypes,scrollTop:r,scale:o,scaleSplitCount:d||10,scaleWidth:g,startLeft:x,minScaleCount:y,maxScaleCount:k,rowHeight:L})),M=e.style,W=A.actionTypes,P=A.tracks,D=A.scrollTop,z=A.autoScroll,j=A.hideCursor,O=A.disableDrag,N=A.scale,U=A.scaleWidth,F=A.startLeft,B=void 0===F?2:F,G=A.minScaleCount,X=A.maxScaleCount,H=A.setTracks,V=A.engine,$=A.autoReRender,K=void 0===$||$,Q=A.onScroll,Y=u.useRef(null),J=u.useRef(),ee=u.useRef(),et=u.useState(h.nW),en=(0,c.Z)(et,2),er=en[0],ei=en[1],eo=u.useState(h.y9),ea=(0,c.Z)(eo,2),ec=ea[0],el=ea[1],es=u.useState(!1),eu=(0,c.Z)(es,2),ed=eu[0],ef=eu[1],eh=u.useState(s()),ev=(0,c.Z)(eh,2),ep=ev[0],eg=ev[1],handleSetScaleCount=function(e){ei(Math.min(X,Math.max(G,e)))};u.useEffect(function(){handleSetScaleCount((0,T.mj)(P,{scale:N})),H&&H(P)},[P,G,X,N]),u.useEffect(function(){null!=V&&V.current&&(V.current.actionTypes=W)},[W]),u.useEffect(function(){null!=V&&V.current&&(V.current.tracks=P)},[P]),u.useEffect(function(){K&&null!=V&&V.current&&V.current.reRender()},[P]),u.useEffect(function(){ee.current&&ee.current.setState({scrollTop:D})},[D]);var handleEditorDataChange=function(e){null!=V&&V.current&&(H(e),V.current.tracks=e,K&&V.current.reRender())},handleSetCursor=function(e){var t=e.left,n=e.time,r=e.updateTime;if(void 0!==t||void 0!==n){void 0===t&&(t=(0,T.ES)(n,{startLeft:B,scale:N,scaleWidth:U})),void 0===n&&(n=(0,T.bW)(t,{startLeft:B,scale:N,scaleWidth:U}));var i=!0;return(void 0===r||r)&&(i=V.current.setTime(n),K&&V.current.reRender()),i&&el(n),i}},setHorizontalScroll=function(e){ee.current.setState({scrollLeft:Math.max(e,0)})},handleDeltaScrollLeft=function(e){!(ee.current.state.scrollLeft+e>er*(U-1)+B-ep)&&ee.current&&setHorizontalScroll(ee.current.state.scrollLeft+e)};return u.useEffect(function(){null!=V&&V.current&&(V.current.on("setTimeByTick",function(e){handleSetCursor({time:e.time,updateTime:!1})}),V.current.on("play",function(){return ef(!0)}),V.current.on("paused",function(){return ef(!1)}))},[V]),u.useImperativeHandle(t,function(){var e,t,n,r,i;return{get target(){return Y.current},get listener(){return V.current},get isPlaying(){var o;return null===(o=V.current)||void 0===o?void 0:o.isPlaying},get isPaused(){var c;return null===(c=V.current)||void 0===c?void 0:c.isPaused},setPlayRate:null==V?void 0:null===(e=V.current)||void 0===e?void 0:e.setPlayRate.bind(V.current),getPlayRate:null==V?void 0:null===(t=V.current)||void 0===t?void 0:t.getPlayRate.bind(V.current),setTime:function(e){return handleSetCursor({time:e})},getTime:null==V?void 0:null===(n=V.current)||void 0===n?void 0:n.getTime.bind(V.current),reRender:null==V?void 0:null===(r=V.current)||void 0===r?void 0:r.reRender.bind(V.current),play:function(e){var t;return null==V?void 0:null===(t=V.current)||void 0===t?void 0:t.play((0,a.Z)({},e))},pause:null==V?void 0:null===(i=V.current)||void 0===i?void 0:i.pause.bind(V.current),setScrollLeft:function(e){if(null!=ee&&ee.current){var t;null==ee||null===(t=ee.current)||void 0===t||t.setState({scrollLeft:Math.max(e,0)})}},setScrollTop:function(e){if(ee.current){var t;null===(t=ee.current)||void 0===t||t.setState({scrollTop:Math.max(e,0)})}}}},[V]),u.useEffect(function(){var e=new ResizeObserver(function(){J.current&&eg(J.current.getBoundingClientRect().width)});return void 0===J.current&&ep===s()&&e.observe(J.current),function(){e&&e.disconnect()}},[]),(0,R.jsxs)(q,{style:M,sx:e.sx,ref:Y,className:"".concat(h.Bq," ").concat(O?"".concat(h.Bq,"-disable"):""),children:[(0,R.jsx)(f.Ew,{ref:ee,children:function(e){var t=e.scrollLeft,n=e.scrollTop,r=e.onScroll;return(0,R.jsxs)(u.Fragment,{children:[(0,R.jsx)(TimeArea,(0,a.Z)((0,a.Z)({},A),{},{timelineWidth:ep,disableDrag:O||ed,setCursor:handleSetCursor,cursorTime:ec,tracks:P,scaleCount:er,setScaleCount:handleSetScaleCount,onScroll:r,scrollLeft:t})),(0,R.jsx)(I,(0,a.Z)((0,a.Z)({},A),{},{timelineWidth:ep,ref:function(e){J.current=null==e?void 0:e.domRef.current},disableDrag:O||ed,tracks:P,cursorTime:ec,scaleCount:er,setScaleCount:handleSetScaleCount,scrollTop:n,scrollLeft:t,setEditorData:handleEditorDataChange,deltaScrollLeft:z&&handleDeltaScrollLeft,actionTypes:W,onScroll:function(e){r(e),Q&&Q(e)}})),!j&&(0,R.jsx)(Cursor,(0,a.Z)((0,a.Z)({},A),{},{timelineWidth:ep,disableDrag:ed,scrollLeft:t,scaleCount:er,setScaleCount:handleSetScaleCount,setCursor:handleSetCursor,cursorTime:ec,tracks:P,areaRef:J,scrollSync:ee,deltaScrollLeft:z&&handleDeltaScrollLeft}))]})}}),(0,R.jsx)(TimelineScrollResizer_ScrollResizer,{parentRef:J,selector:"[role=grid]",scale:U,scrollLeft:null===(E=ee.current)||void 0===E?void 0:null===(_=E.state)||void 0===_?void 0:_.scrollLeft,maxScale:20*U,minScale:1,setScale:e.setScaleWidth,setHorizontalScroll:setHorizontalScroll})]})})},80835:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(36063),i=n(45711),o=n(56902),a=n(43880),c=n(76760),l=n(78536),s=n(27740),u=n(74174),d=n(43640),f=n(21797),h=n.n(f),v=n(5472),p=n.n(v),g=n(51041),m=n.n(g),x=function(){function Emitter(e){(0,a.Z)(this,Emitter),(0,d.Z)(this,"events",{}),this.events=e.handlers}return(0,c.Z)(Emitter,[{key:"on",value:function(e,t){var n=this;return(e instanceof Array?e:e.split(" ")).forEach(function(e){if(!n.events[e])throw Error("The event ".concat(e," does not exist"));n.events[e].push(t)}),this}},{key:"trigger",value:function(e,t){if(!(e in this.events))throw Error("The event ".concat(String(e)," cannot be triggered"));return this.events[e].reduce(function(e,n){return!1!==n(t)&&e},!0)}},{key:"bind",value:function(e){if(this.events[e])throw Error("The event ".concat(e," is already bound"));this.events[e]=[]}},{key:"exist",value:function(e){return p()(this.events[e])}},{key:"off",value:function(e,t){if(this.events[e]){var n=this.events[e];if(t){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}else this.events[e]=[]}}},{key:"offAll",value:function(){this.events=Object.fromEntries(m()(this.events).map(function(e){return[e,[]]}))}}]),Emitter}(),b=(0,c.Z)(function Events(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.Z)(this,Events),(0,d.Z)(this,"handlers",{}),this.handlers=(0,r.Z)({beforeSetTime:[],afterSetTime:[],setTimeByTick:[],beforeSetPlayRate:[],afterSetPlayRate:[],setActiveActionIds:[],play:[],paused:[],ended:[]},e)}),y=function(e){(0,s.Z)(TimelineEngine,e);var t=(0,u.Z)(TimelineEngine);function TimelineEngine(e){var n;return(0,a.Z)(this,TimelineEngine),n=t.call(this,new b),(0,d.Z)((0,l.Z)(n),"_canvas",void 0),(0,d.Z)((0,l.Z)(n),"_loading",!0),(0,d.Z)((0,l.Z)(n),"_viewer",void 0),(0,d.Z)((0,l.Z)(n),"_timerId",void 0),(0,d.Z)((0,l.Z)(n),"_playRate",1),(0,d.Z)((0,l.Z)(n),"_currentTime",0),(0,d.Z)((0,l.Z)(n),"_playState","paused"),(0,d.Z)((0,l.Z)(n),"_prev",void 0),(0,d.Z)((0,l.Z)(n),"_actionTypes",{}),(0,d.Z)((0,l.Z)(n),"_actionMap",{}),(0,d.Z)((0,l.Z)(n),"_actionTrackMap",{}),(0,d.Z)((0,l.Z)(n),"_actionSortIds",[]),(0,d.Z)((0,l.Z)(n),"_next",0),(0,d.Z)((0,l.Z)(n),"_activeActionIds",[]),n._canvas=null==e?void 0:e.canvas,n}return(0,c.Z)(TimelineEngine,[{key:"canvas",get:function(){return this._canvas},set:function(e){this._canvas=e}},{key:"getAction",value:function(e){return{action:this._actionMap[e],track:this._actionTrackMap[e]}}},{key:"getActionTrack",value:function(e){return this._actionTrackMap[e]}},{key:"getSelectedActions",value:function(){for(var e=[],t=0;t<this._activeActionIds.length;t+=1){var n=this._activeActionIds[t],r=this._actionMap[n];r.selected&&e.push({action:r,track:this._actionTrackMap[n]})}return e}},{key:"loading",get:function(){return this._loading}},{key:"isPlaying",get:function(){return"playing"===this._playState}},{key:"isPaused",get:function(){return"paused"===this._playState}},{key:"viewer",get:function(){return this._viewer},set:function(e){this._viewer=e,this._viewerUpdate(),this._loading=!1}},{key:"actionTypes",set:function(e){this._actionTypes=e}},{key:"tracks",set:function(e){this.isPlaying&&this.pause(),this._dealData(e),this._dealClear(),this._dealEnter(this._currentTime)}},{key:"setPlayRate",value:function(e){return e<=0?(console.error("Error: rate cannot be less than 0!"),!1):!!this.trigger("beforeSetPlayRate",{rate:e,engine:this})&&(this._playRate=e,this.trigger("afterSetPlayRate",{rate:e,engine:this}),!0)}},{key:"getPlayRate",value:function(){return this._playRate}},{key:"reRender",value:function(){this.isPlaying||this._tickAction(this._currentTime)}},{key:"setTime",value:function(e,t){return!!(t||this.trigger("beforeSetTime",{time:e,engine:this}))&&(this._currentTime=e,this._next=0,this._dealLeave(e),this._dealEnter(e),t?this.trigger("setTimeByTick",{time:e,engine:this}):this.trigger("afterSetTime",{time:e,engine:this}),!0)}},{key:"getTime",value:function(){return this._currentTime}},{key:"play",value:function(e){var t=this,n=e.toTime,r=e.autoEnd,i=this.getTime();return!this.isPlaying&&(!n||!(n<=i))&&(this._playState="playing",this._startOrStop("start"),this.trigger("play",{engine:this}),this._timerId=requestAnimationFrame(function(e){t._prev=e,t._tick({now:e,autoEnd:r,to:n})}),!0)}},{key:"pause",value:function(){this.isPlaying&&(this._playState="paused",this._startOrStop("stop"),this.trigger("paused",{engine:this})),cancelAnimationFrame(this._timerId)}},{key:"_end",value:function(){this.pause(),this.trigger("ended",{engine:this})}},{key:"_viewerUpdate",value:function(){var e,t=h()(this._actionTypes),n=(0,o.Z)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r&&r.viewerUpdate&&r.viewerUpdate(this)}}catch(e){n.e(e)}finally{n.f()}}},{key:"_verifyLoaded",value:function(){if(this.loading){var e=Error("start or stop before finished loading");return console.log(e,e.stack),!1}return!0}},{key:"_startOrStop",value:function(e){if(this._verifyLoaded())for(var t=0;t<this._activeActionIds.length;t+=1){var n=this._activeActionIds[t],r=this._actionMap[n],i=this._actionTypes[null==r?void 0:r.effectId];"start"===e&&null!=i&&i.start?i.start({action:r,time:this.getTime(),engine:this}):"stop"===e&&null!=i&&i.stop&&i.stop({action:r,time:this.getTime(),engine:this})}}},{key:"_tick",value:function(e){var t=this;if(this._verifyLoaded()&&!this.isPaused){var n=e.now,r=e.autoEnd,i=e.to,o=this.getTime()+Math.min(1e3,n-this._prev)/1e3*this._playRate;if(this._prev=n,i&&i<=o&&(o=i),this.setTime(o,!0),this._tickAction(o),!i&&r&&this._next>=this._actionSortIds.length&&0===this._activeActionIds.length){this._end();return}i&&i<=o&&this._end(),this.isPaused||(this._timerId=requestAnimationFrame(function(e){t._tick({now:e,autoEnd:r,to:i})}))}}},{key:"_tickAction",value:function(e){if(this._verifyLoaded()){this._dealEnter(e),this._dealLeave(e);for(var t=this._activeActionIds.length,n=0;n<t;n+=1){var r=this._activeActionIds[n],i=this._actionMap[r],o=this._actionTypes[i.effectId];o&&null!=o&&o.update&&o.update({action:i,time:this.getTime(),engine:this})}}}},{key:"_dealClear",value:function(){for(;this._activeActionIds.length;){var e=this._activeActionIds.shift(),t=this._actionMap[e],n=this._actionTypes[null==t?void 0:t.effectId];null!=n&&n.leave&&n.leave({action:t,time:this.getTime(),engine:this})}this._next=0}},{key:"_dealEnter",value:function(e){for(;this._actionSortIds[this._next];){var t=this._actionSortIds[this._next],n=this._actionMap[t];if(!n.disable){if(n.start>e)break;if(n.end>e&&!this._activeActionIds.includes(t)){var r=this._actionTypes[n.effectId];r&&null!=r&&r.enter&&null!=n&&n.data&&r.enter({action:n,time:this.getTime(),engine:this}),this._activeActionIds.push(t)}}this._next+=1}}},{key:"_dealLeave",value:function(e){for(var t=0;this._activeActionIds[t];){var n=this._activeActionIds[t],r=this._actionMap[n];if(r.start>e||r.end<e){var i=this._actionTypes[r.effectId];i&&null!=i&&i.leave&&i.leave({action:r,time:this.getTime(),engine:this}),this._activeActionIds.splice(t,1);continue}t+=1}}},{key:"_dealData",value:function(e){var t=this,n=[];null==e||e.forEach(function(e){n.push.apply(n,(0,i.Z)(e.actions)),e.actions.forEach(function(n){t._actionTrackMap[n.id]=e})});var o=n.sort(function(e,t){return e.start-t.start}),a={},c=[];o.forEach(function(e){c.push(e.id),a[e.id]=(0,r.Z)({},e)}),this._actionMap=a,this._actionSortIds=c}}]),TimelineEngine}(x)},88252:function(e,t,n){n.d(t,{d:function(){return x}});var r=n(36063),i=n(17942),o=n(83254),a=n.n(o),c=n(66286),l=n.n(c),s=n(15704),u=n.n(s),d=n(53882),f=n.n(d),h=n(92379),v=n(65184),p=n(27776),g=n.n(p),InteractComp=function(e){var t=e.children,n=e.interactRef,i=e.draggable,o=e.resizable,a=e.draggableOptions,c=e.resizableOptions,l=(0,h.useRef)(),s=(0,h.useRef)(),u=(0,h.useRef)(),d=(0,h.useRef)();(0,h.useEffect)(function(){u.current=(0,r.Z)({},a),d.current=(0,r.Z)({},c)},[a,c]),(0,h.useEffect)(function(){s.current&&s.current.unset(),s.current=g()(l.current),n.current=s.current,setInteractions()},[i,o]);var setInteractions=function(){i&&s.current.draggable((0,r.Z)((0,r.Z)({},u.current),{},{onstart:function(e){return u.current.onstart&&u.current.onstart(e)},onmove:function(e){return u.current.onmove&&u.current.onmove(e)},onend:function(e){return u.current.onend&&u.current.onend(e)}})),o&&s.current.resizable((0,r.Z)((0,r.Z)({},d.current),{},{onstart:function(e){return d.current.onstart&&d.current.onstart(e)},onmove:function(e){return d.current.onmove&&d.current.onmove(e)},onend:function(e){return d.current.onend&&d.current.onend(e)}}))};return(0,h.cloneElement)(t,{ref:l,draggable:!1})},m=n(651),x=h.forwardRef(function(e,t){var n,o,c,s,d=e.children,p=e.edges,g=e.left,x=e.width,b=e.start,y=void 0===b?v.Rz:b,S=e.grid,T=void 0===S?v.e6:S,w=e.bounds,k=void 0===w?{left:a(),right:l()}:w,C=e.enableResizing,R=e.enableDragging,L=e.adsorptionDistance,Z=void 0===L?v.G1:L,E=e.adsorptionPositions,_=void 0===E?[]:E,A=e.onResizeStart,M=e.onResize,W=e.onResizeEnd,P=e.onDragStart,D=e.onDragEnd,I=e.onDrag,z=e.parentRef,j=e.deltaScrollLeft,O=(0,h.useRef)(),N=(0,h.useRef)(0),U=(0,h.useRef)(!1),F=(n=(0,h.useRef)(a()),o=(0,h.useRef)(l()),c=(0,h.useRef)(1),s=(0,h.useRef)(),{initAutoScroll:function(){if(null!=z&&z.current){var e=z.current.getBoundingClientRect(),t=e.left,r=e.width;n.current=t,o.current=t+r}},dealDragAutoScroll:function(e,t){if(e.clientX>=o.current||e.clientX<=n.current){cancelAnimationFrame(s.current);var r=Math.abs(e.clientX>=o.current?e.clientX-o.current:e.clientX-n.current);c.current=Math.min(1*Number((r/10).toFixed(0)),3);var i=(e.clientX>=o.current?1:-1)*c.current;return s.current=requestAnimationFrame(function loop(){t&&t(i),s.current=requestAnimationFrame(loop)}),!1}return cancelAnimationFrame(s.current),!0},dealResizeAutoScroll:function(e,t,r){if(e.clientX>=o.current||e.clientX<n.current){cancelAnimationFrame(s.current);var i=Math.abs(e.clientX>=o.current?e.clientX-o.current:e.clientX-n.current);c.current=Math.min(1*Number((i/10).toFixed(0)),3);var a=(e.clientX>=o.current?1:-1)*c.current;return s.current=requestAnimationFrame(function loop(){r&&r(a),s.current=requestAnimationFrame(loop)}),!1}return cancelAnimationFrame(s.current),!0},stopAutoScroll:function(){n.current=a(),o.current=l(),c.current=1,cancelAnimationFrame(s.current)}}),B=F.initAutoScroll,G=F.dealDragAutoScroll,X=F.dealResizeAutoScroll,H=F.stopAutoScroll;(0,h.useEffect)(function(){return function(){O.current&&O.current.unset()}},[]),(0,h.useImperativeHandle)(t,function(){return{updateLeft:function(e){return handleUpdateLeft(e||0,!1)},updateWidth:function(e){return handleUpdateWidth(e,!1)},getLeft:handleGetLeft,getWidth:handleGetWidth}}),(0,h.useEffect)(function(){var e=O.current.target;handleUpdateWidth(void 0===x?e.offsetWidth:x,!1)},[x]),(0,h.useEffect)(function(){handleUpdateLeft(g||0,!1)},[g]);var handleUpdateLeft=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(O.current&&O.current.target){t&&(N.current=0);var n=O.current.target;n.style.left="".concat(e,"px"),(0,i.Z)(n.dataset,{left:e})}},handleUpdateWidth=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(O.current&&O.current.target){t&&(N.current=0);var n=O.current.target;n.style.width="".concat(e,"px"),(0,i.Z)(n.dataset,{width:e})}},handleGetLeft=function(){var e,t=O.current.target;return u()((null==t?void 0:null===(e=t.dataset)||void 0===e?void 0:e.left)||"0")},handleGetWidth=function(){var e,t=O.current.target;return u()((null==t?void 0:null===(e=t.dataset)||void 0===e?void 0:e.width)||"0")},move=function(e){var t=e.preLeft,n=e.preWidth,r=e.scrollDelta,i=U.current?Z:T;if(Math.abs(N.current)>=i){var o=t+f()(N.current/i+"")*i,a=o,c=l();if(_.forEach(function(e){var t=Math.abs(e-o);t<Z&&t<c&&(a=e);var r=Math.abs(e-(o+n));r<Z&&r<c&&(a=e-n)}),a!==o?(U.current=!0,o=a):((o-y)%T!=0&&(o=y+T*Math.round((o-y)/T)),U.current=!1),N.current=N.current%i,o<k.left?o=k.left:o+n>k.right&&(o=k.right-n),I&&!1===I({lastLeft:t,left:o,lastWidth:n,width:n},r))return;handleUpdateLeft(o,!1)}},resize=function(e){var t=e.dir,n=e.preWidth,r=e.preLeft,i=U.current?Z:T;if("left"===t){if(Math.abs(N.current)>=i){var o=r+f()(N.current/i+"")*i,a=o,c=l();_.forEach(function(e){var t=Math.abs(e-o);t<Z&&t<c&&(a=e)}),a!==o?(U.current=!0,o=a):((o-y)%T!=0&&(o=y+T*Math.round((o-y)/T)),U.current=!1),N.current=N.current%i,o<k.left&&(o=k.left);var s=r+n-o;if(M&&!1===M("left",{lastLeft:r,lastWidth:n,left:o,width:s}))return;handleUpdateLeft(o,!1),handleUpdateWidth(s,!1)}}else if("right"===t&&Math.abs(N.current)>=i){var u=n+f()(N.current/T+"")*T,d=r+u,h=l();if(_.forEach(function(e){var t=Math.abs(e-(r+u));t<Z&&t<h&&(d=e)}),d!==r+u)U.current=!0,u=d-r;else{var v=r+u;(v-y)%T!=0&&(u=(v=y+T*Math.round((v-y)/T))-r),U.current=!1}if(N.current=N.current%i,r+u>k.right&&(u=k.right-r),M&&!1===M("right",{lastLeft:r,lastWidth:n,left:r,width:u}))return;handleUpdateWidth(u,!1)}};return(0,m.jsx)(InteractComp,{interactRef:O,draggable:void 0===R||R,resizable:void 0===C||C,draggableOptions:{lockAxis:"x",onmove:function(e){var t=e.target;if(!j||null==z||!z.current||G(e,function(e){j(e);var n=t.dataset,r=n.left,i=n.width,o=u()(r),a=u()(i);N.current+=e,move({preLeft:o,preWidth:a,scrollDelta:e})})){var n=t.dataset,r=n.left,i=n.width,o=u()(r),a=u()(i);N.current+=e.dx,move({preLeft:o,preWidth:a})}},onstart:function(e){N.current=0,U.current=!1,B(),P&&P()},onend:function(e){N.current=0,U.current=!1,H();var t=e.target.dataset,n=t.left,r=t.width;D&&D({left:u()(n),width:u()(r)})},cursorChecker:function(){return null}},resizableOptions:{axis:"x",invert:"none",edges:(0,r.Z)({left:!0,right:!0,top:!1,bottom:!1},p||{}),onmove:function(e){var t,n=e.target,r=null!==(t=e.edges)&&void 0!==t&&t.left?"left":"right";if(!j||null==z||!z.current||X(e,r,function(e){j(e);var t=n.dataset,i=t.left,o=t.width,a=u()(i),c=u()(o);N.current+=e,resize({preLeft:a,preWidth:c,dir:r})})){var i=n.dataset,o=i.left,a=i.width,c=u()(o),l=u()(a);N.current+="left"===r?e.deltaRect.left:e.deltaRect.right,resize({preLeft:c,preWidth:l,dir:r})}},onstart:function(e){N.current=0,U.current=!1,B();var t,n=null!==(t=e.edges)&&void 0!==t&&t.right?"right":"left";A&&A(n)},onend:function(e){N.current=0,U.current=!1,H();var t,n=e.target.dataset,r=n.left,i=n.width,o=null!==(t=e.edges)&&void 0!==t&&t.right?"right":"left";W&&W(o,{left:u()(r),width:u()(i)})}},children:h.cloneElement(d,{style:(0,r.Z)((0,r.Z)({},d.props.style||{}),{},{left:g,width:x})})})})},65184:function(e,t,n){n.d(t,{A$:function(){return o},A9:function(){return h},Bq:function(){return r},G1:function(){return u},I:function(){return c},IO:function(){return a},Rz:function(){return l},b0:function(){return d},e6:function(){return s},nW:function(){return f},y9:function(){return i}});var r="timeline-editor",i=0,o=1,a=10,c=160,l=20,s=1,u=8,d=32,f=20,h=5},77378:function(e,t,n){n.d(t,{O:function(){return prefix}});var r=n(9258),i=n(65184);function prefix(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.tI.apply(void 0,["".concat(i.Bq,"-")].concat(t))}},92411:function(e,t,n){n.d(t,{EB:function(){return parserActionsToPositions},ES:function(){return parserTimeToPixel},RD:function(){return parserTimeToTransform},bW:function(){return parserPixelToTime},mj:function(){return getScaleCountByRows},o$:function(){return parserTransformToTime},rQ:function(){return getScaleCountByPixel}});var r=n(65184);function parserTimeToPixel(e,t){return t.startLeft+e/t.scale*t.scaleWidth}function parserPixelToTime(e,t){var n=t.startLeft,r=t.scale;return(e-n)/t.scaleWidth*r}function parserTransformToTime(e,t){var n=e.left,r=e.width;return{start:parserPixelToTime(n,t),end:parserPixelToTime(n+r,t)}}function parserTimeToTransform(e,t){var n=e.start,r=e.end,i=parserTimeToPixel(n,t),o=parserTimeToPixel(r,t)-i;return{left:i,width:o}}function getScaleCountByRows(e,t){var n=0;return null==e||e.forEach(function(e){e.actions.forEach(function(e){n=Math.max(n,e.end)})}),Math.ceil(n/t.scale)+r.A9}function getScaleCountByPixel(e,t){return Math.max(Math.ceil((e-t.startLeft)/t.scaleWidth)+r.A9,t.scaleCount)}function parserActionsToPositions(e,t){var n=[];return e.forEach(function(e){n.push(parserTimeToPixel(e.start,t)),n.push(parserTimeToPixel(e.end,t))}),n}}}]);